import React, { useState, useEffect } from "react";

interface AdminPasswordPromptProps {
  onPasswordSet: (token: string) => void;
}

export const AdminPasswordPrompt: React.FC<AdminPasswordPromptProps> = ({
  onPasswordSet,
}) => {
  const [password, setPassword] = useState("");
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    const savedToken = localStorage.getItem("adminApiToken");
    if (savedToken) {
      onPasswordSet(savedToken);
    }
  }, []);

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();

    if (!password.trim()) {
      setError("Please enter your admin password.");
      return;
    }

    // Save password in localStorage (used as Bearer token)
    localStorage.setItem("adminApiToken", password.trim());
    onPasswordSet(password.trim());
  };

  return (
    <form
      onSubmit={handleSubmit}
      className="p-4 border border-blue-400 rounded bg-blue-50 max-w-sm mx-auto mt-10"
    >
      <h2 className="text-lg font-semibold mb-3">Enter Admin API Password</h2>
      <input
        type="password"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
        placeholder="Admin Password"
        className="w-full border px-3 py-2 rounded mb-2"
      />
      {error && <p className="text-red-600 text-sm mb-2">{error}</p>}
      <button
        type="submit"
        className="bg-blue-600 text-white px-4 py-2 rounded w-full"
      >
        Submit
      </button>
    </form>
  );
};
 